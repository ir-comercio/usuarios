<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Usu√°rios</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <h1 class="splash-title">Gerenciamento de Usu√°rios</h1>
    </div>

    <!-- Conte√∫do Principal -->
    <div class="app-content">
        <div class="container">
            <div class="header">
                <h1>üë• Gerenciamento de Usu√°rios</h1>
                <div id="connectionStatus" class="connection-status offline">
                    <span class="status-dot"></span>
                </div>
            </div>

            <div class="button-wrapper">
                <button onclick="toggleForm()" class="register">‚ûï Novo Usu√°rio</button>
            </div>

            <!-- Dashboard -->
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-label">Total de Usu√°rios</div>
                    <div class="stat-value" id="statTotal">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Usu√°rios Ativos</div>
                    <div class="stat-value stat-success" id="statAtivos">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Usu√°rios Inativos</div>
                    <div class="stat-value stat-danger" id="statInativos">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Administradores</div>
                    <div class="stat-value stat-warning" id="statAdmins">0</div>
                </div>
            </div>

            <!-- FILTROS -->
            <div class="card">
                <h2>Filtros</h2>
                <div class="filter-section">
                    <div class="form-group">
                        <label for="search">Pesquisar</label>
                        <input type="text" id="search" placeholder="Nome, username..." oninput="filterUsers()">
                    </div>
                    <div class="form-group">
                        <label for="filterStatus">Status</label>
                        <select id="filterStatus" onchange="filterUsers()">
                            <option value="">Todos</option>
                            <option value="true">Ativos</option>
                            <option value="false">Inativos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="filterAdmin">Tipo</label>
                        <select id="filterAdmin" onchange="filterUsers()">
                            <option value="">Todos</option>
                            <option value="true">Administradores</option>
                            <option value="false">Usu√°rios</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Abas -->
            <div class="card">
                <div class="tabs">
                    <button class="tab-button active" onclick="switchTab('usuarios')">üë• Usu√°rios</button>
                    <button class="tab-button" onclick="switchTab('tentativas')">üîê Tentativas de Login</button>
                    <button class="tab-button" onclick="switchTab('dispositivos')">üì± Dispositivos</button>
                </div>

                <!-- Aba: Usu√°rios -->
                <div id="tabUsuarios" class="tab-content active">
                    <h2>Lista de Usu√°rios</h2>
                    <div id="usersContainer"></div>
                </div>

                <!-- Aba: Tentativas de Login -->
                <div id="tabTentativas" class="tab-content">
                    <h2>Tentativas de Login (√öltimas 100)</h2>
                    <div id="attemptsContainer"></div>
                </div>

                <!-- Aba: Dispositivos Autorizados -->
                <div id="tabDispositivos" class="tab-content">
                    <h2>Dispositivos Autorizados</h2>
                    <div id="devicesContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: FORMUL√ÅRIO DE USU√ÅRIO -->
    <div id="modalForm" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeForm()">&times;</span>
            <h2 id="formTitle">Novo Usu√°rio</h2>
            <form id="userForm" onsubmit="handleSubmit(event)">
                <div class="form-group">
                    <label for="name">Nome Completo *</label>
                    <input type="text" id="name" required>
                </div>

                <div class="form-group">
                    <label for="username">Nome de Usu√°rio *</label>
                    <input type="text" id="username" required pattern="[a-z0-9_]+" title="Apenas letras min√∫sculas, n√∫meros e underscore">
                    <small>Apenas letras min√∫sculas, n√∫meros e underscore (_)</small>
                </div>

                <div class="form-group">
                    <label for="password">Senha *</label>
                    <input type="password" id="password" minlength="6">
                    <small id="passwordHint">M√≠nimo 6 caracteres</small>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="is_admin">
                        <span>Administrador</span>
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="is_active" checked>
                        <span>Ativo</span>
                    </label>
                </div>

                <div class="form-actions">
                    <button type="button" onclick="closeForm()" class="btn-secondary">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL: VISUALIZAR USU√ÅRIO -->
    <div id="modalView" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeViewModal()">&times;</span>
            <h2>Detalhes do Usu√°rio</h2>
            <div id="userDetails"></div>
            <div class="form-actions">
                <button onclick="closeViewModal()" class="btn-primary">Fechar</button>
            </div>
        </div>
    </div>

    <!-- MODAL: TELA DE ACESSO NEGADO -->
    <div id="modalAccessDenied" class="modal" style="display: none;">
        <div class="modal-content access-denied">
            <h2>üîí Acesso Negado</h2>
            <p>Voc√™ n√£o tem permiss√£o para acessar este sistema.</p>
            <p>Entre em contato com o administrador.</p>
            <button onclick="voltarParaPortal()" class="btn-primary">Voltar ao Portal</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
